<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Data Visualization | Applied Statistics in Environment and Ecology</title>
  <meta name="description" content="A book to support content in ERS 669." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Data Visualization | Applied Statistics in Environment and Ecology" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A book to support content in ERS 669." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Data Visualization | Applied Statistics in Environment and Ecology" />
  
  <meta name="twitter:description" content="A book to support content in ERS 669." />
  

<meta name="author" content="Dr. Brad Fedy" />


<meta name="date" content="2024-01-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data.html"/>
<link rel="next" href="data-exploration.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#rstudio"><i class="fa fa-check"></i><b>2.2</b> RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#before-you-begin"><i class="fa fa-check"></i><b>2.3</b> Before you begin</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#setting-a-working-directory"><i class="fa fa-check"></i><b>2.4</b> Setting a working directory</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-help-in-r"><i class="fa fa-check"></i><b>2.5</b> Getting help in R</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#defining-r-objects"><i class="fa fa-check"></i><b>2.6</b> Defining R objects</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#exporting-data-frames"><i class="fa fa-check"></i><b>2.7</b> Exporting data frames</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#installing-and-loading-packages"><i class="fa fa-check"></i><b>2.7.1</b> Installing and loading packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="operators.html"><a href="operators.html"><i class="fa fa-check"></i><b>3</b> Operators</a>
<ul>
<li class="chapter" data-level="3.1" data-path="operators.html"><a href="operators.html#manipulating-r-objects"><i class="fa fa-check"></i><b>3.1</b> Manipulating R objects</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data.html"><a href="data.html#writing-scripts"><i class="fa fa-check"></i><b>4.1</b> Writing scripts</a></li>
<li class="chapter" data-level="4.2" data-path="data.html"><a href="data.html#importing-viewing-and-editing-data"><i class="fa fa-check"></i><b>4.2</b> Importing, viewing, and editing data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data.html"><a href="data.html#summarizing-and-manipulating-data"><i class="fa fa-check"></i><b>4.2.1</b> Summarizing and manipulating data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>5</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-visualization.html"><a href="data-visualization.html#plotting-data"><i class="fa fa-check"></i><b>5.1</b> Plotting data</a></li>
<li class="chapter" data-level="5.2" data-path="data-visualization.html"><a href="data-visualization.html#manipulating-plots"><i class="fa fa-check"></i><b>5.2</b> Manipulating plots</a></li>
<li class="chapter" data-level="5.3" data-path="data-visualization.html"><a href="data-visualization.html#adding-low-level-plotting-functions"><i class="fa fa-check"></i><b>5.3</b> Adding low-level plotting functions</a></li>
<li class="chapter" data-level="5.4" data-path="data-visualization.html"><a href="data-visualization.html#facet-plots"><i class="fa fa-check"></i><b>5.4</b> Facet plots</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>6</b> Data Exploration</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-exploration.html"><a href="data-exploration.html#outliers"><i class="fa fa-check"></i><b>6.1</b> Outliers</a></li>
<li class="chapter" data-level="6.2" data-path="data-exploration.html"><a href="data-exploration.html#homoscedasticity-homegeneity-of-variance"><i class="fa fa-check"></i><b>6.2</b> Homoscedasticity (homegeneity of variance)</a></li>
<li class="chapter" data-level="6.3" data-path="data-exploration.html"><a href="data-exploration.html#distribution-of-the-response-variable"><i class="fa fa-check"></i><b>6.3</b> Distribution of the response variable</a></li>
<li class="chapter" data-level="6.4" data-path="data-exploration.html"><a href="data-exploration.html#collinearity-among-x-variables"><i class="fa fa-check"></i><b>6.4</b> Collinearity among x variables</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics in Environment and Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualization" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Data Visualization<a href="data-visualization.html#data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="plotting-data" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Plotting data<a href="data-visualization.html#plotting-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In addition to statistical analysis and programming capabilities, R produces publishable quality graphics. Base R has the capacity to create excellent graphs; however, the syntax can sometimes feel a little clunky. Most recent graphing examples that you find online will make use of the wildly popular and exceptionally user-friendly package <code>ggplot2</code>. We will use this package throughout this book. There is a excellent book that describes all the details of this package called the <a href="https://r-graphics.org/">R Graphics Cookbook</a>. This chapter will introduce some basic level plotting and options and show you how to modify these options to customize plots. The next chapter will cover Data Exploration (i.e., summarizing and visualizing your data in order to inform your data analysis approach).</p>
<p>The first step is to install and load and the <code>ggplot2</code> package. We will also load a data set containing information on Eastern Fox Snakes (“efs_growth.csv”). This data set investigates eastern fox snake (<em>Pantherophis gloydi</em>) growth rates (“grate”) in two different regions in Ontario (“region”). Reptiles have indeterminate growth (i.e., grow throughout their entire lives), but their growth rates decline as they get older. The dataset also includes measurements on snout-to-vent length (“svl”; a proxy of age).</p>
<p><img src="images/EFS.jpg" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="data-visualization.html#cb69-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="data-visualization.html#cb70-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb70-2"><a href="data-visualization.html#cb70-2" tabindex="-1"></a>efs<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;DATA/efs_growth.csv&quot;</span>,<span class="at">sep=</span><span class="st">&quot;,&quot;</span>,<span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-3"><a href="data-visualization.html#cb70-3" tabindex="-1"></a><span class="fu">head</span>(efs)</span></code></pre></div>
<pre><code>##   Year days         ID region sex  SVL  grate
## 1 2007  333 4415685726  Essex   f 1270 -0.353
## 2 2010  369 4940181800  Essex   m  858  1.178
## 3 2009  730 4962583337  Essex   m 1042  0.340
## 4 2007  357 133637351a  Essex   f 1070  0.643
## 5 2007  415 133768254a  Essex   f  915  0.815
## 6 2008  711 134713166a  Essex   m  816  0.853</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="data-visualization.html#cb72-1" tabindex="-1"></a><span class="fu">str</span>(efs)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    207 obs. of  7 variables:
##  $ Year  : int  2007 2010 2009 2007 2007 2008 2008 2007 2009 2008 ...
##  $ days  : int  333 369 730 357 415 711 378 368 371 354 ...
##  $ ID    : chr  &quot;4415685726&quot; &quot;4940181800&quot; &quot;4962583337&quot; &quot;133637351a&quot; ...
##  $ region: chr  &quot;Essex&quot; &quot;Essex&quot; &quot;Essex&quot; &quot;Essex&quot; ...
##  $ sex   : chr  &quot;f&quot; &quot;m&quot; &quot;m&quot; &quot;f&quot; ...
##  $ SVL   : num  1270 858 1042 1070 915 ...
##  $ grate : num  -0.353 1.178 0.34 0.643 0.815 ...</code></pre>
<p>Imagine that we wanted to make a plot that displayed growth rate as a function of their snout-to-vent length (“svl”; a proxy of age). To plot with <code>ggplot</code>, we use the function <code>ggplot()</code>, which creates a coordinate system that we can then add layers to. The first argument for the <code>ggplot()</code> function is the data set that we want to use. In our case, the data set we want to use is ‘efs’, which we loaded into our environment above. We then add one or more layers to our ggplot with a <code>geom_</code> function. <code>Geoms</code> are geometric objects, like points, lines, or bars that we can add to our ggplot coordinate system. In this example, we will create a scatterplot with <code>geom_point</code> comparing “svl” to “grate”.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="data-visualization.html#cb74-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>efs,<span class="fu">aes</span>(<span class="at">x=</span>SVL, <span class="at">y=</span>grate)) <span class="sc">+</span></span>
<span id="cb74-2"><a href="data-visualization.html#cb74-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="ASEE_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>As expected, we can see the negative relationship between snout-to-vent length (i.e, age) and growth. This helps us visualize the data, but we can improve the plot by adding better labels and making other manipulations to better visualize our data.</p>
</div>
<div id="manipulating-plots" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Manipulating plots<a href="data-visualization.html#manipulating-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can specify a number of parameters within the <code>geom_</code> function. For example, we can modify the colour, transparency, shape, or size of the points. Don’t forget that you can also use <code>?geom_point</code> to understand what else you can do with this code or other <code>geom_</code> functions.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="data-visualization.html#cb75-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>efs, <span class="fu">aes</span>(<span class="at">x=</span> SVL, <span class="at">y=</span>grate)) <span class="sc">+</span>   </span>
<span id="cb75-2"><a href="data-visualization.html#cb75-2" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>,  <span class="co"># change the colour of points</span></span>
<span id="cb75-3"><a href="data-visualization.html#cb75-3" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.50</span>,  <span class="co"># change the transparency</span></span>
<span id="cb75-4"><a href="data-visualization.html#cb75-4" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">20</span>,  <span class="co"># change the shape of the point</span></span>
<span id="cb75-5"><a href="data-visualization.html#cb75-5" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>)  <span class="co"># change the size of the point</span></span></code></pre></div>
<p><img src="ASEE_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>R use numeric codes to represent different plot characters (<code>pch</code>), specified by the <code>shape</code> option in <code>ggplot2</code>. You can find indexes to these characters online or by typing <code>?pch</code> into the console. R defaults to the variable name. Frequently, these are difficult to decipher outside of your research group and need to be revised for publication and dissemination.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="data-visualization.html#cb76-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>efs, <span class="fu">aes</span>(<span class="at">x=</span> SVL, <span class="at">y=</span>grate)) <span class="sc">+</span>   </span>
<span id="cb76-2"><a href="data-visualization.html#cb76-2" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb76-3"><a href="data-visualization.html#cb76-3" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Snout-to-Vent Length (mm)&quot;</span>,</span>
<span id="cb76-4"><a href="data-visualization.html#cb76-4" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Growth Rate (mm/day)&quot;</span>) <span class="sc">+</span></span>
<span id="cb76-5"><a href="data-visualization.html#cb76-5" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1500</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb76-6"><a href="data-visualization.html#cb76-6" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">3</span>,<span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="ASEE_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>All aspects of the graph are adjustable. It is often helpful to sketch your ideal plot first by hand and then figure out how plot it using <code>ggplot2</code>. You can also use <code>themes</code> in <code>ggplot2</code> to change the overall appearance of your plot and control all non-data display. There are many built-in themes and you can review their details <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">online</a>. You can also create your own <code>theme()</code> that you can replicate across analyses so that all your plots have a similar format. Themes are covered in Chapter 9 of the <a href="https://r-graphics.org/">R Graphics Cookbook</a>. A simple example of how to add a theme to your plot and a legend is here:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="data-visualization.html#cb77-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>efs, <span class="fu">aes</span>(<span class="at">x=</span> SVL, <span class="at">y=</span>grate, <span class="at">colour=</span>region)) <span class="sc">+</span>   </span>
<span id="cb77-2"><a href="data-visualization.html#cb77-2" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb77-3"><a href="data-visualization.html#cb77-3" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Snout-to-Vent Length (mm)&quot;</span>,  <span class="co"># change x label</span></span>
<span id="cb77-4"><a href="data-visualization.html#cb77-4" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Growth Rate (mm/day)&quot;</span>,  <span class="co"># change y label</span></span>
<span id="cb77-5"><a href="data-visualization.html#cb77-5" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">&quot;Region&quot;</span>) <span class="sc">+</span> <span class="co"># colour code points by Region</span></span>
<span id="cb77-6"><a href="data-visualization.html#cb77-6" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1500</span>,<span class="dv">100</span>)) <span class="sc">+</span>  <span class="co"># specify x-scale</span></span>
<span id="cb77-7"><a href="data-visualization.html#cb77-7" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">3</span>,<span class="fl">0.5</span>)) <span class="sc">+</span>  <span class="co"># specify y-scale</span></span>
<span id="cb77-8"><a href="data-visualization.html#cb77-8" tabindex="-1"></a>    <span class="fu">theme_classic</span>()  <span class="co"># specify theme</span></span></code></pre></div>
<p><img src="ASEE_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="adding-low-level-plotting-functions" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Adding low-level plotting functions<a href="data-visualization.html#adding-low-level-plotting-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Low-level plotting functions plot on already existing plots. For example suppose we had preformed a regression and wanted to add a regression line to our plot to further visualize the negative relationship between age and growth rate of Eastern fox snakes. We can do this using the geom_smooth function to add the regression line to the plot.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="data-visualization.html#cb78-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>efs, <span class="fu">aes</span>(<span class="at">x=</span> SVL, <span class="at">y=</span>grate, <span class="at">colour=</span>region)) <span class="sc">+</span>      </span>
<span id="cb78-2"><a href="data-visualization.html#cb78-2" tabindex="-1"></a>        <span class="fu">geom_point</span>()<span class="sc">+</span>   </span>
<span id="cb78-3"><a href="data-visualization.html#cb78-3" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Snout-to-Vent Length (mm)&quot;</span>,        </span>
<span id="cb78-4"><a href="data-visualization.html#cb78-4" tabindex="-1"></a>            <span class="at">y =</span> <span class="st">&quot;Growth Rate (mm/day)&quot;</span>,</span>
<span id="cb78-5"><a href="data-visualization.html#cb78-5" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&quot;Region&quot;</span>) <span class="sc">+</span>   </span>
<span id="cb78-6"><a href="data-visualization.html#cb78-6" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1500</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb78-7"><a href="data-visualization.html#cb78-7" tabindex="-1"></a>        <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">3</span>,<span class="fl">0.5</span>)) <span class="sc">+</span>   </span>
<span id="cb78-8"><a href="data-visualization.html#cb78-8" tabindex="-1"></a>        <span class="fu">theme_classic</span>()<span class="sc">+</span>  <span class="co"># add a theme</span></span>
<span id="cb78-9"><a href="data-visualization.html#cb78-9" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)  <span class="co"># add a regression line to our plot</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="ASEE_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="facet-plots" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Facet plots<a href="data-visualization.html#facet-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When displaying data it is often useful to have multiple items highlighted on a single plot or to have a multi-panel plot for related data. Below we provide an example using this data to make a facet plot with the <code>facet_grid</code> function. Again make sure you use help to understand what is happening with each line of code if it is not familiar to you (e.g, <code>?facet_grid</code>).</p>
<p>Here, we are going to create a plot that compares growth rate with age for females and males at each different region. We will produce two separate plots for each region that compare males and females. We will also add regression lines.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="data-visualization.html#cb80-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>efs, <span class="fu">aes</span>(<span class="at">x=</span> SVL, <span class="at">y=</span>grate, <span class="at">colour=</span>sex)) <span class="sc">+</span>      </span>
<span id="cb80-2"><a href="data-visualization.html#cb80-2" tabindex="-1"></a>        <span class="fu">geom_point</span>()<span class="sc">+</span>   </span>
<span id="cb80-3"><a href="data-visualization.html#cb80-3" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Snout-to-Vent Length (mm)&quot;</span>,        </span>
<span id="cb80-4"><a href="data-visualization.html#cb80-4" tabindex="-1"></a>            <span class="at">y =</span> <span class="st">&quot;Growth Rate (mm/day)&quot;</span>,</span>
<span id="cb80-5"><a href="data-visualization.html#cb80-5" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&quot;Region&quot;</span>) <span class="sc">+</span>   </span>
<span id="cb80-6"><a href="data-visualization.html#cb80-6" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1500</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb80-7"><a href="data-visualization.html#cb80-7" tabindex="-1"></a>        <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">3</span>,<span class="fl">0.5</span>)) <span class="sc">+</span>   </span>
<span id="cb80-8"><a href="data-visualization.html#cb80-8" tabindex="-1"></a>        <span class="fu">theme_classic</span>() <span class="sc">+</span>  <span class="co"># add a theme</span></span>
<span id="cb80-9"><a href="data-visualization.html#cb80-9" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span>  <span class="co"># add a regression line to our plot</span></span>
<span id="cb80-10"><a href="data-visualization.html#cb80-10" tabindex="-1"></a>        <span class="fu">facet_grid</span>(<span class="fu">vars</span>(region))  <span class="co"># add the facet grid for a variable of your choice</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="ASEE_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>Developing your plots in R is a great way to improve and maintain your R skills. This may seem like extra work compared to point-and-clicking your way through Excel to create a similar plot; but coding your plots allows for easy replication, update, sharing, and transparency. The code may look fairly complex to create a simple looking plot, but much of the code repeats and can be reused in future efforts.</p>
<p>The last thing we will do is save our plot to our working directory. You can do this through RStudio with the Export function in the plotting window; however, it is more useful to learn how to save with code so that you can make specifications to your figure size and file type. This can be accomplished using the <code>ggsave</code> function to output the figure with a specific size and file type. All journals have specifications regarding the size, file type, and resolution of figures for publication. The <code>ggsave</code> function an associated options ensures that you meet those criteria when submitting your research for publication.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="data-visualization.html#cb82-1" tabindex="-1"></a><span class="fu">ggsave</span> (<span class="st">&quot;efs.figure.pdf&quot;</span>, <span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>, <span class="at">width =</span> <span class="fl">7.5</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-exploration.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

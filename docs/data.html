<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data | Applied Statistics in Environment and Ecology</title>
  <meta name="description" content="A book to support content in ERS 669." />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data | Applied Statistics in Environment and Ecology" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A book to support content in ERS 669." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data | Applied Statistics in Environment and Ecology" />
  
  <meta name="twitter:description" content="A book to support content in ERS 669." />
  

<meta name="author" content="Dr. Brad Fedy" />


<meta name="date" content="2025-02-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="operators.html"/>
<link rel="next" href="data-visualization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#rstudio"><i class="fa fa-check"></i><b>2.2</b> RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#before-you-begin"><i class="fa fa-check"></i><b>2.3</b> Before you begin</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#setting-a-working-directory"><i class="fa fa-check"></i><b>2.4</b> Setting a working directory</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-help-in-r"><i class="fa fa-check"></i><b>2.5</b> Getting help in R</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#defining-r-objects"><i class="fa fa-check"></i><b>2.6</b> Defining R objects</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#exporting-data-frames"><i class="fa fa-check"></i><b>2.7</b> Exporting data frames</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#installing-and-loading-packages"><i class="fa fa-check"></i><b>2.7.1</b> Installing and loading packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="operators.html"><a href="operators.html"><i class="fa fa-check"></i><b>3</b> Operators</a>
<ul>
<li class="chapter" data-level="3.1" data-path="operators.html"><a href="operators.html#manipulating-r-objects"><i class="fa fa-check"></i><b>3.1</b> Manipulating R objects</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data.html"><a href="data.html#writing-scripts"><i class="fa fa-check"></i><b>4.1</b> Writing scripts</a></li>
<li class="chapter" data-level="4.2" data-path="data.html"><a href="data.html#importing-viewing-and-editing-data"><i class="fa fa-check"></i><b>4.2</b> Importing, viewing, and editing data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data.html"><a href="data.html#summarizing-and-manipulating-data"><i class="fa fa-check"></i><b>4.2.1</b> Summarizing and manipulating data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>5</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-visualization.html"><a href="data-visualization.html#plotting-data"><i class="fa fa-check"></i><b>5.1</b> Plotting data</a></li>
<li class="chapter" data-level="5.2" data-path="data-visualization.html"><a href="data-visualization.html#manipulating-plots"><i class="fa fa-check"></i><b>5.2</b> Manipulating plots</a></li>
<li class="chapter" data-level="5.3" data-path="data-visualization.html"><a href="data-visualization.html#adding-low-level-plotting-functions"><i class="fa fa-check"></i><b>5.3</b> Adding low-level plotting functions</a></li>
<li class="chapter" data-level="5.4" data-path="data-visualization.html"><a href="data-visualization.html#facet-plots"><i class="fa fa-check"></i><b>5.4</b> Facet plots</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>6</b> Data Exploration</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-exploration.html"><a href="data-exploration.html#outliers"><i class="fa fa-check"></i><b>6.1</b> Outliers</a></li>
<li class="chapter" data-level="6.2" data-path="data-exploration.html"><a href="data-exploration.html#homoscedasticity-homegeneity-of-variance"><i class="fa fa-check"></i><b>6.2</b> Homoscedasticity (homegeneity of variance)</a></li>
<li class="chapter" data-level="6.3" data-path="data-exploration.html"><a href="data-exploration.html#distribution-of-the-response-variable"><i class="fa fa-check"></i><b>6.3</b> Distribution of the response variable</a></li>
<li class="chapter" data-level="6.4" data-path="data-exploration.html"><a href="data-exploration.html#collinearity-among-x-variables"><i class="fa fa-check"></i><b>6.4</b> Collinearity among x variables</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html"><i class="fa fa-check"></i><b>7</b> Correlation and Linear Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#correlation"><i class="fa fa-check"></i><b>7.1</b> Correlation</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#correlation-coefficient"><i class="fa fa-check"></i><b>7.1.1</b> Correlation coefficient</a></li>
<li class="chapter" data-level="7.1.2" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#non-parametric-correlations"><i class="fa fa-check"></i><b>7.1.2</b> Non-parametric correlations</a></li>
<li class="chapter" data-level="7.1.3" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#non-parametic-correlations-in-a-glm-context"><i class="fa fa-check"></i><b>7.1.3</b> Non-parametic correlations in a GLM context</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#regression"><i class="fa fa-check"></i><b>7.2</b> Regression</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#interpreting-output"><i class="fa fa-check"></i><b>7.2.1</b> Interpreting Output</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#model-validation"><i class="fa fa-check"></i><b>7.3</b> Model Validation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>8</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="logistic-regression.html"><a href="logistic-regression.html#binary-response-variable"><i class="fa fa-check"></i><b>8.1</b> Binary Response Variable</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#logit-link-function"><i class="fa fa-check"></i><b>8.1.1</b> Logit Link Function</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="logistic-regression.html"><a href="logistic-regression.html#ecological-applications"><i class="fa fa-check"></i><b>8.2</b> Ecological Applications</a></li>
<li class="chapter" data-level="8.3" data-path="logistic-regression.html"><a href="logistic-regression.html#loggerhead-shrike-example"><i class="fa fa-check"></i><b>8.3</b> Loggerhead Shrike Example</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="logistic-regression.html"><a href="logistic-regression.html#standardize-variables"><i class="fa fa-check"></i><b>8.3.1</b> Standardize variables</a></li>
<li class="chapter" data-level="8.3.2" data-path="logistic-regression.html"><a href="logistic-regression.html#correlations"><i class="fa fa-check"></i><b>8.3.2</b> Correlations</a></li>
<li class="chapter" data-level="8.3.3" data-path="logistic-regression.html"><a href="logistic-regression.html#model-fitting"><i class="fa fa-check"></i><b>8.3.3</b> Model Fitting</a></li>
<li class="chapter" data-level="8.3.4" data-path="logistic-regression.html"><a href="logistic-regression.html#plot-coefficients"><i class="fa fa-check"></i><b>8.3.4</b> Plot Coefficients</a></li>
<li class="chapter" data-level="8.3.5" data-path="logistic-regression.html"><a href="logistic-regression.html#plot-model-predictions"><i class="fa fa-check"></i><b>8.3.5</b> Plot Model Predictions</a></li>
<li class="chapter" data-level="8.3.6" data-path="logistic-regression.html"><a href="logistic-regression.html#model-assessment"><i class="fa fa-check"></i><b>8.3.6</b> Model Assessment</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics in Environment and Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Data<a href="data.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="writing-scripts" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Writing scripts<a href="data.html#writing-scripts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When writing R scripts there are a couple things to keep in mind that will make your life much easier. Future you, will thank present you. Most of the time you will write your scripts in an R script file and then send your commands to the R Console from that file. Always start your code with a text header that provides information about your script file so that future you (and others) know what the script does and can reproduce your analysis. At a minimum I suggest the following:</p>
<ul>
<li>Brief description of the script (i.e., a title)</li>
<li>The date the script was created or last modified (there are more elegant ways to keep track of this that we will address later)</li>
<li>The author of the script</li>
<li>R version used when creating the script (R packages change. This is important.)</li>
</ul>
<p>Other items that I ask everyone in my research group to include are:</p>
<ul>
<li>Packages required to run the code (there are more elegant ways to keep track of this that we will also address alter)</li>
<li>Data inputs and sources</li>
<li>Data outputs</li>
</ul>
<p>Here is an example of the Header text I try to include in all my scripts. Obviously, not all this information is available at the beginning of an analysis, but I encourage you to update your header as you go.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="data.html#cb54-1" tabindex="-1"></a><span class="co">#=============================================================================#</span></span>
<span id="cb54-2"><a href="data.html#cb54-2" tabindex="-1"></a><span class="co"># HEADER ---------------------------------------------------------------------</span></span>
<span id="cb54-3"><a href="data.html#cb54-3" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-4"><a href="data.html#cb54-4" tabindex="-1"></a><span class="co">#  Author: Brad Fedy</span></span>
<span id="cb54-5"><a href="data.html#cb54-5" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-6"><a href="data.html#cb54-6" tabindex="-1"></a><span class="co">#  R.Version(): Version 4.3.1</span></span>
<span id="cb54-7"><a href="data.html#cb54-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-8"><a href="data.html#cb54-8" tabindex="-1"></a><span class="co">#  Project: </span></span>
<span id="cb54-9"><a href="data.html#cb54-9" tabindex="-1"></a><span class="co">#  Grassland birds habitat selection</span></span>
<span id="cb54-10"><a href="data.html#cb54-10" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-11"><a href="data.html#cb54-11" tabindex="-1"></a><span class="co">#  Required libraries: </span></span>
<span id="cb54-12"><a href="data.html#cb54-12" tabindex="-1"></a><span class="co">#  Mumin, data.table</span></span>
<span id="cb54-13"><a href="data.html#cb54-13" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb54-14"><a href="data.html#cb54-14" tabindex="-1"></a><span class="co">#  Required input files: </span></span>
<span id="cb54-15"><a href="data.html#cb54-15" tabindex="-1"></a><span class="co">#  1. Bird location data e.g., &quot;species.routes.SPPI.csv&quot;</span></span>
<span id="cb54-16"><a href="data.html#cb54-16" tabindex="-1"></a><span class="co">#  2. Covariate values at each scale creaeted in step _3.. Example naming:</span></span>
<span id="cb54-17"><a href="data.html#cb54-17" tabindex="-1"></a><span class="co">#     &quot;SPPI.covariates.`scale&#39;.csv&quot;</span></span>
<span id="cb54-18"><a href="data.html#cb54-18" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-19"><a href="data.html#cb54-19" tabindex="-1"></a><span class="co">#  Steps:</span></span>
<span id="cb54-20"><a href="data.html#cb54-20" tabindex="-1"></a><span class="co">#  1. PREPARE DATA FOR MODELLING</span></span>
<span id="cb54-21"><a href="data.html#cb54-21" tabindex="-1"></a><span class="co">#  2. RUN UNIVARIATE MODELS</span></span>
<span id="cb54-22"><a href="data.html#cb54-22" tabindex="-1"></a><span class="co">#  3. CORRELATIONS AMONG TOP COVARIATES</span></span>
<span id="cb54-23"><a href="data.html#cb54-23" tabindex="-1"></a><span class="co">#  4. UNIVARIATE MODELS FOR ALL CORRELATED PAIRS</span></span>
<span id="cb54-24"><a href="data.html#cb54-24" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-25"><a href="data.html#cb54-25" tabindex="-1"></a><span class="co">#  Output files: </span></span>
<span id="cb54-26"><a href="data.html#cb54-26" tabindex="-1"></a><span class="co">#  1. Table of univariate results across all scales for each variable. </span></span>
<span id="cb54-27"><a href="data.html#cb54-27" tabindex="-1"></a><span class="co">#     e.g., &quot;SPPI.model.result.&quot;,env[[s]],&quot;.csv&quot;</span></span>
<span id="cb54-28"><a href="data.html#cb54-28" tabindex="-1"></a><span class="co">#  2.  Table of univariate results of each highly correlated pair</span></span>
<span id="cb54-29"><a href="data.html#cb54-29" tabindex="-1"></a><span class="co">#     e.g., &quot;SPPI.cor.var.models.&quot;,x,&quot;.csv&quot; where `x&#39; is a number 1 to n pairs</span></span>
<span id="cb54-30"><a href="data.html#cb54-30" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-31"><a href="data.html#cb54-31" tabindex="-1"></a><span class="co">#  Date: 2023/05/13</span></span>
<span id="cb54-32"><a href="data.html#cb54-32" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-33"><a href="data.html#cb54-33" tabindex="-1"></a><span class="co">#  NOTES: </span></span>
<span id="cb54-34"><a href="data.html#cb54-34" tabindex="-1"></a><span class="co">#=============================================================================#</span></span>
<span id="cb54-35"><a href="data.html#cb54-35" tabindex="-1"></a></span>
<span id="cb54-36"><a href="data.html#cb54-36" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb54-37"><a href="data.html#cb54-37" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;/Users/bfedy/grassland.birds/DATA/Bird.Data&quot;</span>)</span>
<span id="cb54-38"><a href="data.html#cb54-38" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MuMIn&quot;</span>)</span>
<span id="cb54-39"><a href="data.html#cb54-39" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;data.table&quot;</span>)</span></code></pre></div>
<p>The formatting of your scripts can be a matter of personal preference. There are a number of style guides available. Hadley Wickham has one associated with his <a href="http://adv-r.had.co.nz/Style.html">Advanced R book</a> and Google’s R Style Guide can be found in multiple locations on the internet. Basically, try to make it readable, easily understood, and do not be shy with your use of <code># comments</code> throughout. You will be grateful later. Really…. more comments are almost always better.</p>
</div>
<div id="importing-viewing-and-editing-data" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Importing, viewing, and editing data<a href="data.html#importing-viewing-and-editing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/sage-grouse.jpg" width="70%" style="display: block; margin: auto;" /></p>
<p>Greater Sage-Grouse (<em>Centrocercus urophasianus</em>; hearafter sage-grouse) are ground nesting bird, distributed across the intermountain west with a range that crosses 11 states and 2 Canadian provinces. They are listed under the Canadian Species At Risk Act and of conservation concern throughout their distribution in the United States. Their distribution is roughly consonant with the distribution of sagebrush (Artemisia sp.) habitat. The major negative impacts to sage-grouse are habitat loss, invasive species, and energy development across their range. Sage-grouse have a lek mating system in which males congregate at breeding sites (i.e., leks) each spring to compete for mating opportunities using elaborate ‘strutting’ displays to attract females. There have been large efforts across their range to collect detailed ecological and population data - typically focused on lek sites. Approximately 35% of the remaining sage-grouse occur in Wyoming. Long term monitoring data exists for many of the active leks across Wyoming which are visited 1-3 times per lek season by biologists who count the number of males displaying at a lek. By convention, the highest number of males recorded across all visits is used as the lek size for a given year. These counts are considered a good index of overall population size and are used to assess trends in population numbers. This ongoing effort was started in 1948 and has resulted in a large dataset with thousands of leks where males have been counted and recorded each year. We will use some of these data to demonstrate approaches that can be used to visualize and analyze a real ecological dataset. Given issues with data ownership and distribution, the data you will be working with are based on real data, but I have adjusted the data by introducing random variation into the counts and spatial lek locations. So the actual data you are working with have similar distributions and challenges associated with the real data, but but are not accurate in terms of lek locations and lek counts. Th</p>
<p>To get you started, we have provided a comma separated values file, which includes summary information on 718 leks from the southern half of the Wyoming. In the figure below you can see distribution of these leks in relation to their range (light grey) across this region.</p>
<p><img src="images/Lek_locs_map.jpg" width="70%" style="display: block; margin: auto;" /></p>
<p>We have summarized the time-series of the leks described and mapped above, by calculating a variety of statistics on the time series form 1982-2013 (“241223wysg_leks.csv”). These data are based on empirical data, but all of the locations and counts have had substantial error introduced so they are not “true” data. This was done due to the sensitivity of the data. Before beginning, get associated with this data by opening it in a text editor and excel. A description of data comprised for each column is listed below.</p>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Name</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>lekid</td>
<td>name of lek</td>
</tr>
<tr class="even">
<td>x</td>
<td>UTM easting coordinates</td>
</tr>
<tr class="odd">
<td>y</td>
<td>UTM northing coordibnates</td>
</tr>
<tr class="even">
<td>area</td>
<td>name of the management ares (i.e., unit)</td>
</tr>
<tr class="odd">
<td>per_miss</td>
<td>percent of years where lek counts were not conducted</td>
</tr>
<tr class="even">
<td>per_zero</td>
<td>percentage of years where no individual males were counted at a lek site</td>
</tr>
<tr class="odd">
<td>mean_count</td>
<td>mean number of peak males counted across the time series</td>
</tr>
<tr class="even">
<td>sd_count</td>
<td>standard deviation of peak males counted across the time series</td>
</tr>
<tr class="odd">
<td>min_count</td>
<td>minimum number of peak males counted across the time series</td>
</tr>
<tr class="even">
<td>max_count</td>
<td>maximum number of peak males counted across the time series</td>
</tr>
<tr class="odd">
<td>len_road</td>
<td>length (m) of raods within 5 km radio of lek</td>
</tr>
<tr class="even">
<td>mean_ppt</td>
<td>mean of July, August, and September 1981-2010 total precipitation for climate zone surrounding lek</td>
</tr>
<tr class="odd">
<td>mean_sage</td>
<td>mean sagebrush percent cover within 5 km radius of lek</td>
</tr>
<tr class="even">
<td>mean_herb</td>
<td>mean herbaceous percent cover within 5 km radius of lek</td>
</tr>
<tr class="odd">
<td>mean_nest</td>
<td>mean nesting habitat suitability for sage-grouse (range: low(0) to high(1)) within 5km radius of lek</td>
</tr>
</tbody>
</table>
<p>Once you are familiar with the data table, open Rstudio and setup a script file (do not forget to save the script file) that you will use to enter your commands throughout all exercises. You can translate your commands from the script to the concole (i.e., run your commands), by highlighting the commands and hitting control-enter on the keyboard. Make sure you input header information before you begin entering commands! It is also important to set your working directory to the directory where your data is saved before attempting to import the data.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="data.html#cb55-1" tabindex="-1"></a><span class="co"># set your working directory</span></span>
<span id="cb55-2"><a href="data.html#cb55-2" tabindex="-1"></a>leks <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;DATA/241223wysg_leks.csv&quot;</span>, <span class="at">sep=</span><span class="st">&quot;,&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>,<span class="at">quote=</span><span class="st">&quot;&quot;</span>,<span class="at">comment.char=</span><span class="st">&quot;&quot;</span>, </span>
<span id="cb55-3"><a href="data.html#cb55-3" tabindex="-1"></a><span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>)  <span class="co"># read in the data</span></span>
<span id="cb55-4"><a href="data.html#cb55-4" tabindex="-1"></a><span class="fu">head</span>(leks)  <span class="co"># look at the first few observations</span></span></code></pre></div>
<pre><code>##              lekid        x       y area per_miss per_zero mean_count sd_count
## 1    D-Alkali Draw -1117044 2253178    D     46.9     50.0     34.529     17.6
## 2  D-Antelope Draw -1154827 2281868    D     28.1     40.6     52.391     45.4
## 3   D-Bench Corral -1148670 2278415    D     25.0     43.8     33.583     28.6
## 4       D-Big John -1099343 2250458    D     50.0     50.0     87.875     19.1
## 5 D-Big Sandy Flat -1088257 2252134    D     25.0     90.6      0.875      3.0
## 6  D-Billie&#39;s Draw -1152847 2275456    D     50.0     71.9     20.062     24.6
##   min_count max_count len_road mean_ppt mean_sage mean_herb mean_nest
## 1         0        67   172473     24.8      14.8      15.9     0.484
## 2         0       133   188797     28.2      16.5      16.7     0.525
## 3         0        87   219941     25.0      14.7      13.8     0.463
## 4        56       119   134197     24.9      14.5      14.3     0.434
## 5         0        14   185886     25.6      16.1      17.0     0.487
## 6         0        73   171083     26.5      16.0      13.4     0.555</code></pre>
<p>There are often issues when importing data. Typically these are caused by variables that contain character data. You can visually inspect your imported data using the <code>view()</code> function or by clicking the data table in your Environment in RStudio. It is useful to always use summary functions to ensure that everything imported as expected. Here we use two such functions.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="data.html#cb57-1" tabindex="-1"></a><span class="fu">dim</span>(leks)  <span class="co"># provide dimensions of the data frame</span></span></code></pre></div>
<pre><code>## [1] 718  15</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="data.html#cb59-1" tabindex="-1"></a><span class="fu">summary</span>(leks)</span></code></pre></div>
<pre><code>##     lekid                 x                  y               area          
##  Length:718         Min.   :-1236354   Min.   :2043637   Length:718        
##  Class :character   1st Qu.:-1129942   1st Qu.:2122548   Class :character  
##  Mode  :character   Median : -980625   Median :2166752   Mode  :character  
##                     Mean   :-1012654   Mean   :2169603                     
##                     3rd Qu.: -910777   3rd Qu.:2208761                     
##                     Max.   : -790076   Max.   :2319509                     
##     per_miss       per_zero       mean_count       sd_count       min_count   
##  Min.   : 0.0   Min.   :  0.0   Min.   :  0.0   Min.   :  0.0   Min.   : 0.0  
##  1st Qu.: 0.0   1st Qu.: 46.9   1st Qu.:  2.6   1st Qu.:  5.8   1st Qu.: 0.0  
##  Median :12.5   Median : 65.6   Median : 10.3   Median : 11.7   Median : 0.0  
##  Mean   :19.9   Mean   : 62.2   Mean   : 16.6   Mean   : 15.6   Mean   : 1.2  
##  3rd Qu.:34.4   3rd Qu.: 81.2   3rd Qu.: 23.8   3rd Qu.: 20.8   3rd Qu.: 0.0  
##  Max.   :81.2   Max.   :100.0   Max.   :159.4   Max.   :104.5   Max.   :80.0  
##    max_count      len_road         mean_ppt      mean_sage       mean_herb   
##  Min.   :  0   Min.   : 35552   Min.   :15.8   Min.   : 0.00   Min.   : 3.8  
##  1st Qu.: 22   1st Qu.:122144   1st Qu.:20.9   1st Qu.: 8.00   1st Qu.: 8.2  
##  Median : 42   Median :155570   Median :23.9   Median : 9.99   Median :11.5  
##  Mean   : 56   Mean   :160325   Mean   :24.4   Mean   :10.19   Mean   :12.8  
##  3rd Qu.: 77   3rd Qu.:193281   3rd Qu.:27.4   3rd Qu.:12.27   3rd Qu.:16.3  
##  Max.   :350   Max.   :396330   Max.   :35.8   Max.   :19.76   Max.   :51.2  
##    mean_nest    
##  Min.   :0.000  
##  1st Qu.:0.101  
##  Median :0.162  
##  Mean   :0.198  
##  3rd Qu.:0.262  
##  Max.   :0.695</code></pre>
<p>It is useful to check the format of your data. We previously discussed some of the potential issues of storing columns as factors. Check to see if any columns are stored as factors. If needed re-import the data so that no columns are factors.</p>
<div id="summarizing-and-manipulating-data" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Summarizing and manipulating data<a href="data.html#summarizing-and-manipulating-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the key components to any analysis is the ability to summarize and manipulate your data. There are almost as many ways to accomplish common data summary tasks as there are users. We provided some of these basic functions earlier. However, in many cases you will want to summarize a data set using a grouping variable. For example, suppose we wish to determine the mean number of males counted within each of the management areas. One way this can be done using base R is with the <code>tapply()</code> function which applies a function to each group within a vector. To use <code>tapply</code> you supply i) a numeric vector of a data frame to be summarized (<code>X</code>; i.e., your variable of interest), ii) a grouping factor (<code>INDEX</code>), and iii) a function (<code>FUN</code>) to summarize the numeric vector:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="data.html#cb61-1" tabindex="-1"></a><span class="fu">tapply</span>(<span class="at">X=</span>leks<span class="sc">$</span>mean_count,<span class="at">INDEX=</span>leks<span class="sc">$</span>area,<span class="at">FUN=</span>mean)</span></code></pre></div>
<pre><code>##     D     E     F     G     H 
## 30.96 28.49  8.53 16.68 13.14</code></pre>
<p>This example used <code>mean</code>; however, <code>tapply</code> can be used with any built in function (e.g., <code>sum()</code>, <code>sd()</code>, <code>length()</code>, <code>max()</code>, <code>min()</code>) or with a customized function of your own design. In addition to this flexibility, more than one grouping factor can be incorporated. For example, suppose we had some idea of a breakpoint between high and low quality nesting habitat for leks and we wanted to calculate a summary table describing the mean male counts for low and high suitability leks within each management area. To accomplish this we first need to create an additional variable, which groups the leks into ‘low’ or ‘high’ suitability groupings.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="data.html#cb63-1" tabindex="-1"></a>leks<span class="sc">$</span>nest_type<span class="ot">&lt;-</span><span class="st">&quot;low&quot;</span>  <span class="co"># create a nesting suitability variable </span></span>
<span id="cb63-2"><a href="data.html#cb63-2" tabindex="-1"></a>leks[leks<span class="sc">$</span>mean_nest<span class="sc">&gt;</span><span class="fl">0.3</span>,<span class="st">&quot;nest_type&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;high&quot;</span>  <span class="co"># change rows with values &gt; 0.3 to &#39;high&#39;</span></span>
<span id="cb63-3"><a href="data.html#cb63-3" tabindex="-1"></a>leks_sort<span class="ot">&lt;-</span>leks[<span class="fu">order</span>(leks<span class="sc">$</span>nest_type),] <span class="co">#  sort data frame by nest_type</span></span></code></pre></div>
<p>Above we also use the <code>order()</code> function to sort the data frame by our new variable. Note that when we sort the data frame we create a new data frame, so the original data remains unmodified. View the sorted data frame to ensure the new variable is correctly assigned. After creating this variable you can use the <code>tapply</code> function with both the management area (area) and the newly created nest_type variable:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="data.html#cb64-1" tabindex="-1"></a>lek_summary<span class="ot">&lt;-</span><span class="fu">aggregate</span>(<span class="at">x=</span>leks_sort<span class="sc">$</span>mean_count,<span class="at">by=</span><span class="fu">list</span>(leks_sort<span class="sc">$</span>area,leks_sort<span class="sc">$</span>nest_type), <span class="at">FUN=</span>mean)</span>
<span id="cb64-2"><a href="data.html#cb64-2" tabindex="-1"></a>lek_summary</span></code></pre></div>
<pre><code>##    Group.1 Group.2     x
## 1        D    high 35.78
## 2        E    high 33.26
## 3        F    high 17.14
## 4        G    high 30.51
## 5        H    high  8.43
## 6        D     low 21.84
## 7        E     low 23.56
## 8        F     low  8.02
## 9        G     low 14.63
## 10       H     low 13.60</code></pre>
<p>The original data came in the form of a time series over multiple years. These summaries were created using the <code>apply()</code> function, which can be used to apply a function across rows (<code>MARGIN=1</code>) or down columns (<code>MARGIN=2</code>). To use these summaries, load the time series data using the <code>readtable</code> function.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="data.html#cb66-1" tabindex="-1"></a>lek_ts<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">&quot;DATA/wysg_peak_males_ts_sub.csv&quot;</span>,<span class="at">sep=</span><span class="st">&quot;,&quot;</span>,<span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb66-2"><a href="data.html#cb66-2" tabindex="-1"></a><span class="fu">head</span>(lek_ts)</span></code></pre></div>
<pre><code>##              lekid X2008 X2009 X2010 X2011 X2012 X2013
## 1   B-Blue Mesa 24    16    13    16    13     9     5
## 2  B-Grass Creek 2     0    17     4     5    12     7
## 3       B-Hoodoo 3    31    12    11     9     5     2
## 4   B-Logging Road    24    42    31    10    12    12
## 5          C-Innes    34    29    19    14    15    12
## 6 C-Upton-Fairview    11    13    12    10    17     9</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="data.html#cb68-1" tabindex="-1"></a><span class="co"># take mean across last 5 rows and add to new column</span></span>
<span id="cb68-2"><a href="data.html#cb68-2" tabindex="-1"></a>lek_ts<span class="sc">$</span>mean_count<span class="ot">&lt;-</span><span class="fu">apply</span>(<span class="at">X=</span>lek_ts[,<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>],<span class="at">MARGIN=</span><span class="dv">1</span>,<span class="at">FUN=</span>mean) </span>
<span id="cb68-3"><a href="data.html#cb68-3" tabindex="-1"></a><span class="fu">head</span>(lek_ts)</span></code></pre></div>
<pre><code>##              lekid X2008 X2009 X2010 X2011 X2012 X2013 mean_count
## 1   B-Blue Mesa 24    16    13    16    13     9     5       12.0
## 2  B-Grass Creek 2     0    17     4     5    12     7        7.5
## 3       B-Hoodoo 3    31    12    11     9     5     2       11.7
## 4   B-Logging Road    24    42    31    10    12    12       21.8
## 5          C-Innes    34    29    19    14    15    12       20.5
## 6 C-Upton-Fairview    11    13    12    10    17     9       12.0</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="operators.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

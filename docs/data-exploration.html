<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Data Exploration | Applied Statistics in Environment and Ecology</title>
  <meta name="description" content="A book to support content in ERS 669." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Data Exploration | Applied Statistics in Environment and Ecology" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A book to support content in ERS 669." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Data Exploration | Applied Statistics in Environment and Ecology" />
  
  <meta name="twitter:description" content="A book to support content in ERS 669." />
  

<meta name="author" content="Dr. Brad Fedy" />


<meta name="date" content="2024-02-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-visualization.html"/>
<link rel="next" href="correlation-and-linear-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#rstudio"><i class="fa fa-check"></i><b>2.2</b> RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#before-you-begin"><i class="fa fa-check"></i><b>2.3</b> Before you begin</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#setting-a-working-directory"><i class="fa fa-check"></i><b>2.4</b> Setting a working directory</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-help-in-r"><i class="fa fa-check"></i><b>2.5</b> Getting help in R</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#defining-r-objects"><i class="fa fa-check"></i><b>2.6</b> Defining R objects</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#exporting-data-frames"><i class="fa fa-check"></i><b>2.7</b> Exporting data frames</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#installing-and-loading-packages"><i class="fa fa-check"></i><b>2.7.1</b> Installing and loading packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="operators.html"><a href="operators.html"><i class="fa fa-check"></i><b>3</b> Operators</a>
<ul>
<li class="chapter" data-level="3.1" data-path="operators.html"><a href="operators.html#manipulating-r-objects"><i class="fa fa-check"></i><b>3.1</b> Manipulating R objects</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data.html"><a href="data.html#writing-scripts"><i class="fa fa-check"></i><b>4.1</b> Writing scripts</a></li>
<li class="chapter" data-level="4.2" data-path="data.html"><a href="data.html#importing-viewing-and-editing-data"><i class="fa fa-check"></i><b>4.2</b> Importing, viewing, and editing data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data.html"><a href="data.html#summarizing-and-manipulating-data"><i class="fa fa-check"></i><b>4.2.1</b> Summarizing and manipulating data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>5</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-visualization.html"><a href="data-visualization.html#plotting-data"><i class="fa fa-check"></i><b>5.1</b> Plotting data</a></li>
<li class="chapter" data-level="5.2" data-path="data-visualization.html"><a href="data-visualization.html#manipulating-plots"><i class="fa fa-check"></i><b>5.2</b> Manipulating plots</a></li>
<li class="chapter" data-level="5.3" data-path="data-visualization.html"><a href="data-visualization.html#adding-low-level-plotting-functions"><i class="fa fa-check"></i><b>5.3</b> Adding low-level plotting functions</a></li>
<li class="chapter" data-level="5.4" data-path="data-visualization.html"><a href="data-visualization.html#facet-plots"><i class="fa fa-check"></i><b>5.4</b> Facet plots</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>6</b> Data Exploration</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-exploration.html"><a href="data-exploration.html#outliers"><i class="fa fa-check"></i><b>6.1</b> Outliers</a></li>
<li class="chapter" data-level="6.2" data-path="data-exploration.html"><a href="data-exploration.html#homoscedasticity-homegeneity-of-variance"><i class="fa fa-check"></i><b>6.2</b> Homoscedasticity (homegeneity of variance)</a></li>
<li class="chapter" data-level="6.3" data-path="data-exploration.html"><a href="data-exploration.html#distribution-of-the-response-variable"><i class="fa fa-check"></i><b>6.3</b> Distribution of the response variable</a></li>
<li class="chapter" data-level="6.4" data-path="data-exploration.html"><a href="data-exploration.html#collinearity-among-x-variables"><i class="fa fa-check"></i><b>6.4</b> Collinearity among x variables</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html"><i class="fa fa-check"></i><b>7</b> Correlation and Linear Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#correlation"><i class="fa fa-check"></i><b>7.1</b> Correlation</a></li>
<li class="chapter" data-level="7.2" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#regression"><i class="fa fa-check"></i><b>7.2</b> Regression</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#interpreting-output"><i class="fa fa-check"></i><b>7.2.1</b> Interpreting Output</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#model-validation"><i class="fa fa-check"></i><b>7.3</b> Model Validation</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics in Environment and Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-exploration" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Data Exploration<a href="data-exploration.html#data-exploration" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Before conducting any statistical analysis you need to graphically explore your data. There are many packages within R to assist you with the process of data exploration. Many of the reasons behind data exploration and methodology are outlined in a review article in Methods in Ecology and Evolution by Zuur et al. (2010). We are pattern matching machines. We have evolved to visually detect patterns among the chaos. It is important to use that strength to visually inspect your data, understand its nuances, and allow that information to help inform your analyses in model structure.</p>
<p>We will cover general (and generalized) linear models in detail later in the course. However, it is necessary to introduce a simple model here to better explain why we recommend generating the plots in this chapter.</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1x_1 + \beta_2x_2 +  ...+ \beta_jx_i + \epsilon_i\]</span></p>
<p>In this model, we are trying to understand the relationship between a number of covariates (<span class="math inline">\(x_1, x_2\)</span>) on the response variable of interest (<span class="math inline">\(y_i\)</span>). The <span class="math inline">\(x_i\)</span> and <span class="math inline">\(y_1\)</span> represent actual data and measurements we have gathered. The model used that information to estimate the relationships among those variables. The shape and direction of the relationship between a particular <span class="math inline">\(x_i\)</span> and our response variable <span class="math inline">\(y_i\)</span> is describe by the slope estimates (e.g., <span class="math inline">\(\beta_1, \beta_2\)</span>). In this relatively simple example, the model estimates two other parameters. The model intercept, <span class="math inline">\(\beta_0\)</span> and the error term <span class="math inline">\(\epsilon_i\)</span>. This type of model can contain multiple <span class="math inline">\(x\)</span> variables and both the <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> values may be discrete (i.e, values are individual, separated and distinct) or continuous (i.e., unbroken values between a range). The nature of the data (i.e., continuous or discrete) will change how you plot the variables. For this example, we will work with sage-grouse lek data.</p>
<p>One of the key questions driving much of wildlife ecology (honestly, much of most of ecology) is: how many animals are there? With the obvious follow up question of: why? Animal populations are influenced by a wide variety of environmental feature. Suppose we were interested in determining if mean peak male counts (continuous <span class="math inline">\(y\)</span> variable) were influenced by landscape or climate variables (continuous <span class="math inline">\(x\)</span> variables) within the different management units (i.e., a discrete <span class="math inline">\(x\)</span> variable) or within high and low nesting quality habitats (i.e., another discrete <span class="math inline">\(x\)</span> variable). Before you begin with the code you need to load the lek data and add a grouping factor named “nest_type” which divides the leks into high (&gt;0.3) and low suitability (&lt;=0.3). This was covered in previous chapters.</p>
<p>Unfortunately, in almost all field-base research, missing data is a reality. This is true of the sage-grouse data that we are using. Not all leks are surveyed every year. We will discuss how to deal with missing data in more depth in other parts of the course. For now, we want to remove leks from the analysis that have ‘too much’ missing data. We have chosen a 50% missing data as a cutoff for inclusion based on research by Dr. Fedy exploring the impact of missing data and frequency of counts on lek population dynamic estimates. Therefore, we create a new lek dataset for exploration and analysis, by removing any leks where no individuals were counted across the whole time period (i.e., inactive leks) and those with more than 50 percent missing data. We are not going to do any statistical analysis on this dataset for now, but below we use graphical analysis to test a number of the statistical assumptions outlined in Zuur et al. (2010).</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="data-exploration.html#cb83-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;ggplot2&#39;</span>)</span>
<span id="cb83-2"><a href="data-exploration.html#cb83-2" tabindex="-1"></a>leks<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;DATA/wysg_peak_males.csv&quot;</span>,<span class="at">sep=</span><span class="st">&quot;,&quot;</span>,<span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb83-3"><a href="data-exploration.html#cb83-3" tabindex="-1"></a>leks<span class="sc">$</span>nest_type<span class="ot">&lt;-</span><span class="st">&quot;low&quot;</span>  <span class="co"># create a nesting suitability variable</span></span>
<span id="cb83-4"><a href="data-exploration.html#cb83-4" tabindex="-1"></a>leks[leks<span class="sc">$</span>mean_nest<span class="sc">&gt;</span><span class="fl">0.3</span>,<span class="st">&quot;nest_type&quot;</span>]<span class="ot">&lt;-</span><span class="st">&quot;high&quot;</span>  <span class="co"># change rows with values &gt; 0.3 to &#39;high&#39;</span></span>
<span id="cb83-5"><a href="data-exploration.html#cb83-5" tabindex="-1"></a>leks_sub<span class="ot">&lt;-</span>leks[leks<span class="sc">$</span>max_count <span class="sc">!=</span> <span class="dv">0</span>,]  <span class="co"># subset with non-zero rows</span></span>
<span id="cb83-6"><a href="data-exploration.html#cb83-6" tabindex="-1"></a>leks_sub<span class="ot">&lt;-</span>leks_sub[leks_sub<span class="sc">$</span>per_miss <span class="sc">&lt;</span> <span class="dv">50</span>,]  <span class="co"># subset for missing data</span></span></code></pre></div>
<div id="outliers" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Outliers<a href="data-exploration.html#outliers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Statistical outliers (i.e., data points that are distant from other data points in the dataset) can dominate the results of statistical analysis. Thus, outliers should be identified prior to statistical analysis so they can be removed or fixed if proper justification is found (e.g., error in data entry) or their effects on the analyses can be quantified if they are true biological outliers. As in Zuur et al., 2010 we use box plots and Cleveland dot plots on our y variable. You will see below that although there are no egregious outliers, some may warrant attention. To create the 2-panel plot, we will use the <code>cowplot</code> package. Don’t forget to install and load the package before using the functions that require <code>cowplot</code>. Try and play around a bit with the <code>plot_grid</code> function, see how you can create different plot displays.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="data-exploration.html#cb84-1" tabindex="-1"></a><span class="co"># To make the two panel plot, we first assign the two plots to objects in R</span></span>
<span id="cb84-2"><a href="data-exploration.html#cb84-2" tabindex="-1"></a><span class="co"># Create the boxplot</span></span>
<span id="cb84-3"><a href="data-exploration.html#cb84-3" tabindex="-1"></a>boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(leks_sub, <span class="fu">aes</span>(<span class="at">y=</span>mean_count))<span class="sc">+</span>   </span>
<span id="cb84-4"><a href="data-exploration.html#cb84-4" tabindex="-1"></a>            <span class="fu">geom_boxplot</span>() <span class="sc">+</span>   </span>
<span id="cb84-5"><a href="data-exploration.html#cb84-5" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Mean peak males&quot;</span>) <span class="sc">+</span>   </span>
<span id="cb84-6"><a href="data-exploration.html#cb84-6" tabindex="-1"></a>            <span class="fu">theme_bw</span>()</span>
<span id="cb84-7"><a href="data-exploration.html#cb84-7" tabindex="-1"></a></span>
<span id="cb84-8"><a href="data-exploration.html#cb84-8" tabindex="-1"></a><span class="co"># Create the Cleveland dot chart</span></span>
<span id="cb84-9"><a href="data-exploration.html#cb84-9" tabindex="-1"></a>dotplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(leks_sub, <span class="fu">aes</span>(<span class="at">x=</span>mean_count, <span class="at">y=</span><span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(mean_count),<span class="dv">1</span>))) <span class="sc">+</span>   </span>
<span id="cb84-10"><a href="data-exploration.html#cb84-10" tabindex="-1"></a>            <span class="fu">geom_point</span>() <span class="sc">+</span>   </span>
<span id="cb84-11"><a href="data-exploration.html#cb84-11" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Mean peak males&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Order of the data&quot;</span>) <span class="sc">+</span>    </span>
<span id="cb84-12"><a href="data-exploration.html#cb84-12" tabindex="-1"></a>            <span class="fu">theme_bw</span>()</span>
<span id="cb84-13"><a href="data-exploration.html#cb84-13" tabindex="-1"></a></span>
<span id="cb84-14"><a href="data-exploration.html#cb84-14" tabindex="-1"></a><span class="co"># Now plot them in the same window using the cowplot package</span></span>
<span id="cb84-15"><a href="data-exploration.html#cb84-15" tabindex="-1"></a><span class="co">#install.packages(&quot;cowplot&quot;, quiet=TRUE) # code for installing package</span></span>
<span id="cb84-16"><a href="data-exploration.html#cb84-16" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;cowplot&quot;</span>, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span>
<span id="cb84-17"><a href="data-exploration.html#cb84-17" tabindex="-1"></a></span>
<span id="cb84-18"><a href="data-exploration.html#cb84-18" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(boxplot, dotplot)</span></code></pre></div>
<p><img src="ASEE_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>In the previous chapter we created multipanel plots using the <code>facet_grid</code> function. Here we used the cowplot to create a multipanel plot that displays the results from the two separate plots. Below we plot the mean peak male count and a number of landscape and climatic factors that are potentially having an effect on the number of males in a single plot. Before creating this plot, we create a subset matrix that can be used with the <code>facet_wrap function</code>. Once we create the new susbet matrix of data that only contains the mean_count and climate variables of interest, we will use code formatted based on the ‘tidyverse’, which uses pipes (<code>%&gt;%</code>), to format the dataset prior to plotting. The ‘tidyverse’ is a popular data science group of packages and coding style used to ‘tidy’ messy data to facilitate analysis and visualization. I use ‘tidyverse’ occasionally, but I am not a diehard convert. If you want to delve deeper into the ‘tidyverse’ I recommend the excellent book, <a href="https://r4ds.hadley.nz/">R for Data Science</a> which delves deep into the tidyverse universe and covers many important topics in data science. I take a pragmatic approach throughout this book and the course. I do not really care what packages you use, as long as it works.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="data-exploration.html#cb85-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="data-exploration.html#cb86-1" tabindex="-1"></a><span class="co"># create a matrix by binding only the columns we are interested in</span></span>
<span id="cb86-2"><a href="data-exploration.html#cb86-2" tabindex="-1"></a>ex_data<span class="ot">&lt;-</span><span class="fu">cbind</span>(leks_sub<span class="sc">$</span>mean_count,leks_sub<span class="sc">$</span>length_road,leks_sub<span class="sc">$</span>mean_sb,              </span>
<span id="cb86-3"><a href="data-exploration.html#cb86-3" tabindex="-1"></a>            leks_sub<span class="sc">$</span>mean_herb,leks_sub<span class="sc">$</span>mean_nest,leks_sub<span class="sc">$</span>mean_ppt) </span>
<span id="cb86-4"><a href="data-exploration.html#cb86-4" tabindex="-1"></a><span class="co"># name the columns</span></span>
<span id="cb86-5"><a href="data-exploration.html#cb86-5" tabindex="-1"></a><span class="fu">colnames</span>(ex_data)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;mean_count&quot;</span>,<span class="st">&quot;length_road&quot;</span>,<span class="st">&quot;mean_sb&quot;</span>,                      </span>
<span id="cb86-6"><a href="data-exploration.html#cb86-6" tabindex="-1"></a>                    <span class="st">&quot;mean_herb&quot;</span>,<span class="st">&quot;mean_nest&quot;</span>,<span class="st">&quot;mean_ppt&quot;</span>)</span>
<span id="cb86-7"><a href="data-exploration.html#cb86-7" tabindex="-1"></a><span class="co"># create a new data set by converting the matrix to a data frame</span></span>
<span id="cb86-8"><a href="data-exploration.html#cb86-8" tabindex="-1"></a>ex_data2 <span class="ot">&lt;-</span> ex_data <span class="sc">%&gt;%</span>   </span>
<span id="cb86-9"><a href="data-exploration.html#cb86-9" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span>   </span>
<span id="cb86-10"><a href="data-exploration.html#cb86-10" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">value =</span> <span class="st">&quot;value&quot;</span>)    </span>
<span id="cb86-11"><a href="data-exploration.html#cb86-11" tabindex="-1"></a><span class="co"># plot the data</span></span>
<span id="cb86-12"><a href="data-exploration.html#cb86-12" tabindex="-1"></a><span class="fu">ggplot</span>(ex_data2, <span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">y=</span><span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(value),<span class="dv">1</span>))) <span class="sc">+</span>   </span>
<span id="cb86-13"><a href="data-exploration.html#cb86-13" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span>   </span>
<span id="cb86-14"><a href="data-exploration.html#cb86-14" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Value of the variable&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Order of the data&quot;</span>) <span class="sc">+</span>    </span>
<span id="cb86-15"><a href="data-exploration.html#cb86-15" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span>   </span>
<span id="cb86-16"><a href="data-exploration.html#cb86-16" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="ASEE_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="homoscedasticity-homegeneity-of-variance" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Homoscedasticity (homegeneity of variance)<a href="data-exploration.html#homoscedasticity-homegeneity-of-variance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An important assumption in many statistical analysis is that variance (i.e., spread of data points) is similar between groups (e.g., sexes, different experimental treatments). Essentially, this assumption means that the residuals from a model have equal variance (homoscedasticity) for every fitted value and the predictors. Meeting this assumption ensures accurate calculation of standard errors for the parameter estimates. Thus, if we were interested in determining if the mean peak number of males for leks was different depending on the management area or the surrounding categorical nesting quality it would be important to explore this assumption. Here we see the true value of these graphing packages as they easily allow us to compare the distributions within one or more grouping factors using a box plot.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="data-exploration.html#cb87-1" tabindex="-1"></a><span class="fu">ggplot</span>(leks_sub, <span class="fu">aes</span>(<span class="at">x=</span>man_area, <span class="at">y=</span>mean_count))<span class="sc">+</span></span>
<span id="cb87-2"><a href="data-exploration.html#cb87-2" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb87-3"><a href="data-exploration.html#cb87-3" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Management Area&quot;</span>, <span class="at">y=</span><span class="st">&quot;Mean peak males&quot;</span>)<span class="sc">+</span></span>
<span id="cb87-4"><a href="data-exploration.html#cb87-4" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb87-5"><a href="data-exploration.html#cb87-5" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>nest_type)</span></code></pre></div>
<p><img src="ASEE_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>Based on the plots above, it appears that we are violating the assumption of homogeneity of variance with some management areas having much lower variation in mean peak counts than others. We will discuss how to deal with this type of situation later in the course. But, these results suggest we may need to refine our research questions or account for these differences in our model development. Homoscedacity assumption determines how many variances are to be estimated: either one overall variance of the response variable, or several variances for different values of the explanatory variables. In the latter case, both the mean and the variance of the response variable change with the explanatory variables. We will get deeper into this when we discuss General(ized) Linear Models in later chapters particularly when we are discussing model fit.</p>
</div>
<div id="distribution-of-the-response-variable" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Distribution of the response variable<a href="data-exploration.html#distribution-of-the-response-variable" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An assumption in many statistical analyses is that your y variable is normally distributed. A simple way to assess this assumption is to visualize your data using a histogram. Here we use a two panel plot to plot both the mean peak number of males and the log(peak number of males), which is a common statistical transformation used to closer approximate a normal distribution.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="data-exploration.html#cb88-1" tabindex="-1"></a>hist_mean <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(leks_sub, <span class="fu">aes</span>(<span class="at">x=</span>mean_count)) <span class="sc">+</span>                 </span>
<span id="cb88-2"><a href="data-exploration.html#cb88-2" tabindex="-1"></a>                <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">30</span>) <span class="sc">+</span>                 </span>
<span id="cb88-3"><a href="data-exploration.html#cb88-3" tabindex="-1"></a>                <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Mean number of males&quot;</span>, <span class="at">y=</span><span class="st">&quot;Frequency&quot;</span>)<span class="sc">+</span>                 </span>
<span id="cb88-4"><a href="data-exploration.html#cb88-4" tabindex="-1"></a>                <span class="fu">theme_bw</span>()</span>
<span id="cb88-5"><a href="data-exploration.html#cb88-5" tabindex="-1"></a>hist_log <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(leks_sub, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(mean_count))) <span class="sc">+</span>   </span>
<span id="cb88-6"><a href="data-exploration.html#cb88-6" tabindex="-1"></a>                <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">30</span>) <span class="sc">+</span>   </span>
<span id="cb88-7"><a href="data-exploration.html#cb88-7" tabindex="-1"></a>                <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Log(Mean number of males)&quot;</span>, <span class="at">y=</span><span class="st">&quot;Frequency&quot;</span>)<span class="sc">+</span>   </span>
<span id="cb88-8"><a href="data-exploration.html#cb88-8" tabindex="-1"></a>                <span class="fu">theme_bw</span>()                            </span>
<span id="cb88-9"><a href="data-exploration.html#cb88-9" tabindex="-1"></a></span>
<span id="cb88-10"><a href="data-exploration.html#cb88-10" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(hist_mean, hist_log, <span class="at">nrow=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="ASEE_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>Again the lattice package can also be useful for plotting multi-panel plots with multiple variables. Here we use the grouping factor (nest_type) to look for normality within each nest group at the same time.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="data-exploration.html#cb89-1" tabindex="-1"></a><span class="fu">ggplot</span>(leks_sub, <span class="fu">aes</span>(<span class="at">x=</span>mean_count))<span class="sc">+</span></span>
<span id="cb89-2"><a href="data-exploration.html#cb89-2" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">30</span>)<span class="sc">+</span></span>
<span id="cb89-3"><a href="data-exploration.html#cb89-3" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Mean number of males&quot;</span>, <span class="at">y=</span><span class="st">&quot;Frequency&quot;</span>)<span class="sc">+</span></span>
<span id="cb89-4"><a href="data-exploration.html#cb89-4" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>nest_type)<span class="sc">+</span></span>
<span id="cb89-5"><a href="data-exploration.html#cb89-5" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="ASEE_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
<div id="collinearity-among-x-variables" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Collinearity among x variables<a href="data-exploration.html#collinearity-among-x-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When x variables (i.e., predictors) are highly correlated it is difficult to determine their independent effect on the y variable. Thus, it is always a good idea to determine the level of correlation among your predictors. Here we use a scatter plot to visualize the collinearity between the three landscape variables in the <code>ex_data</code> dataframe. Here will use the <code>ggscatmat</code> function from the <code>GGally</code> package to visualize the correlation between variables. You will also notice in the plot that there is a strong positive correlation between sagebrush habitat and nesting quality, which is not surprising given the ecology of sage-grouse and their association with this habitat type.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="data-exploration.html#cb90-1" tabindex="-1"></a><span class="co">#install.packages(&quot;GGally&quot;, dependencies=TRUE, quiet=TRUE) </span></span>
<span id="cb90-2"><a href="data-exploration.html#cb90-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;GGally&quot;</span>, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="data-exploration.html#cb92-1" tabindex="-1"></a><span class="fu">ggscatmat</span>(ex_data, <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)) <span class="co">#columns function selects specific comparisons</span></span></code></pre></div>
<p><img src="ASEE_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="correlation-and-linear-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
